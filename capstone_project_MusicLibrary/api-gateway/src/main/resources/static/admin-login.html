<!doctype html>
<html>
<head>
  <meta charset="utf-8"><title>Admin Login</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {background:#0b1220; color:#e6eef8; font-family:Inter,system-ui;}
    .box {max-width:420px;margin:6vh auto;padding:28px;border-radius:12px;background:linear-gradient(180deg,#0f172a,#081125);}
  </style>
</head>
<body>
<div class="box shadow">
  <h3 class="mb-3">Admin Login</h3>
  <div id="alert"></div>

  <form id="form">
    <div class="mb-2">
      <label class="form-label">Email</label>
      <input id="email" class="form-control" type="email" required>
    </div>
    <div class="mb-3">
      <label class="form-label">Password</label>
      <input id="password" class="form-control" type="password" required>
    </div>

    <div class="d-grid">
      <button class="btn btn-warning">Login</button>
    </div>
  </form>

  <div class="mt-3 text-muted small">Back to <a href="index.html">home</a></div>
</div>

<script>
const API = "http://localhost:9000";
const form = document.getElementById('form');
const alertBox = (html) => document.getElementById('alert').innerHTML = html;

form.addEventListener('submit', async e => {
  e.preventDefault();
  alertBox('');
  const payload = { email: document.getElementById('email').value, password: document.getElementById('password').value };
  try {
    const res = await fetch(API + '/admin/login', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload) });
    const data = await res.json();
    if(!res.ok) throw data;
    // store minimal admin in localStorage
    localStorage.setItem('admin', JSON.stringify({ id: data.id, email: data.email, username: data.username || data.name }));
    window.location.href = 'admin-dashboard.html';
  } catch(err) {
    const msg = (err && err.error) ? err.error : (err.message || 'Login failed');
    alertBox(`<div class="alert alert-danger">${msg}</div>`);
  }
});
</script>
</body>
</html>
