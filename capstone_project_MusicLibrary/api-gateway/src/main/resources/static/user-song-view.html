<!doctype html>
<html>
<head>
  <meta charset="utf-8"><title>Song Details</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>body{background:#f7fafc;padding-bottom:90px}</style>
</head>
<body>
<nav class="navbar navbar-expand bg-white mb-4 shadow-sm">
  <div class="container-fluid">
    <a class="navbar-brand" href="user-songs.html">Back</a>
  </div>
</nav>
<div class="container">
  <div id="content"></div>
</div>

<!-- bottom player -->
<div style="position:fixed;left:0;right:0;bottom:0;background:#111;color:#fff;padding:10px;display:flex;gap:12px;align-items:center">
  <div style="flex:1">
    <div id="title">No song</div>
  </div>
  <div>
    <button id="playBtn" class="btn btn-sm btn-primary">▶</button>
    <button id="pauseBtn" class="btn btn-sm btn-light">⏸</button>
  </div>
</div>
<audio id="audio" style="display:none"></audio>

<script>
const API = "http://localhost:9000";
const params = new URLSearchParams(location.search);
const id = params.get('songId');
const content = document.getElementById('content');
const audio = document.getElementById('audio');
const titleEl = document.getElementById('title');

async function load(){
  try {
    const res = await fetch(`${API}/songs/${id}`);
    if(!res.ok) throw 'Not found';
    const s = await res.json();
    content.innerHTML = `<div class="card p-4"><h3>${s.name}</h3><p class="text-muted">${s.singer||''} • ${s.albumName||''}</p>
      <p><b>Music Director:</b> ${s.musicDirector||'–'}</p>
      <p><b>Release Date:</b> ${s.releaseDate||'–'}</p>
      <div class="mt-3"><button class="btn btn-primary" id="btnPlay">Play</button></div>
      </div>`;
    audio.src = s.fileUrl || "https://www2.cs.uic.edu/~i101/SoundFiles/StarWars3.wav";
    titleEl.innerText = s.name;
    document.getElementById('btnPlay').addEventListener('click', ()=> {
      audio.play(); document.getElementById('playBtn').innerText='⏸';
    });
  } catch(e){ content.innerHTML = '<div class="alert alert-danger">Song not found</div>'; }
}
document.getElementById('playBtn').addEventListener('click', ()=> { if(audio.paused) { audio.play(); document.getElementById('playBtn').innerText='⏸'; } else { audio.pause(); document.getElementById('playBtn').innerText='▶'; }});
document.getElementById('pauseBtn').addEventListener('click', ()=> audio.pause());
load();
</script>
</body>
</html>
