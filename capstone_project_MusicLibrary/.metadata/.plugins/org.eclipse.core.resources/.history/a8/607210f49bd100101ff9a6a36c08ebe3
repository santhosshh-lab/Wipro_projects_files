<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Playlist</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<h2>Playlist Songs</h2>

<input id="songId" placeholder="Song ID">
<button onclick="addSong()">Add Song</button>

<div id="songs"></div>

<script>
let userId = localStorage.getItem("userId");
let playlistId = localStorage.getItem("playlistId");

async function loadSongs() {
    let res = await fetch(`http://localhost:8081/users/${userId}/playlists/${playlistId}/songs`);
    let list = await res.json();

    let html = "";
    list.forEach(s => {
        html += `
            <div class="card">
                <h3>${s.name}</h3>
                <p>${s.singer}</p>
            </div>`;
    });

    document.getElementById("songs").innerHTML = html;
}

async function addSong() {
    let data = {
        songId: parseInt(document.getElementById("songId").value)
    };

    await fetch(`http://localhost:8081/users/${userId}/playlists/${playlistId}/songs`, {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(data)
    });

    loadSongs();
}

loadSongs();
</script>

</body>
</html>
